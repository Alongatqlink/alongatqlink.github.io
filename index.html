<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QLINK VIP Registration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Select2 CSS + Bootstrap4 Theme -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap4-theme@1.6.2/dist/select2-bootstrap4.min.css">
  <style>
    .form-container {
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
    }
    /* 讓 Select2 外觀更像原生 .form-control */
    .select2-container--bootstrap4 .select2-selection--single {
      display: flex !important;
      align-items: center !important;
      height: calc(2.25rem + 2px) !important;
      border: 1px solid #ced4da !important;
      border-radius: .25rem !important;
      background-color: #fff !important;
      padding: 0 !important;
      line-height: 1.5 !important;
    }
    .select2-container--bootstrap4 .select2-selection__rendered {
      margin-top: 0 !important;
      margin-left: .75rem !important;
      margin-right: .75rem !important;
      padding: 0 !important;
      line-height: 1.5 !important;
      color: #495057 !important;
    }
    .select2-container--bootstrap4 .select2-selection__placeholder {
      color: #6c757d !important;
    }
  /* ---------------------------------------- */
/* 以下為新增的「浮水印 logo」樣式（繁體中文註解）  */
/* ---------------------------------------- */

body {
  position: relative;             /* 建立定位上下文，讓偽元素能定位 */
  background-color: #f8f9fa;      /* （可選）淺灰底色，讓白色表單更突出 */
}

body::before {
  content: "";
  position: fixed;                /* 固定在視窗，畫面滾動也不動 */
  top: 0;
  left: 0;
  width: 100vw;                   /* 撐滿整個可視區域 */
  height: 100vh;
  background: url("Screenshot 2025-02-24 at 17.34.46.png")     /* 你的 logo 路徑 */
              no-repeat center center;
  background-size: 550px auto;    /* 根據需求調整 logo 尺寸 */
  opacity: 0.08;                  /* 8% 透明度，不干擾閱讀 */
  pointer-events: none;           /* 不攔截滑鼠事件，不影響表單互動 */
  z-index: -1;                    /* 放在所有內容下面 */
}  
  </style>
</head>
<body>

<div class="form-container">
  <h1>QLINK VIP Registration</h1>
  <form onsubmit="handleSubmit(event)">
    <!-- Dealer Code (Select2) -->
    <div class="form-group">
      <label for="dealerCode">Dealer Code</label>
      <select id="dealerCode" class="form-control" style="width: 100%;">
        <option value=""></option>
      </select>
    </div>

    <!-- Model (Select2) -->
    <div class="form-group">
      <label for="model">Model (e.g. ABC-123)</label>
      <select id="model" class="form-control" style="width: 100%;">
        <option value=""></option>
      </select>
    </div>

    <!-- Product Serial -->
    <div class="form-group">
      <label for="productSerial">Product Serial (No special characters such as *%@#$&/^~().)</label>
      <input type="text" class="form-control" id="productSerial" placeholder="Enter product serial">
    </div>

    <!-- Customer Name -->
    <div class="form-group">
      <label for="CustomerName">Customer Name</label>
      <input type="text" class="form-control" id="CustomerName" placeholder="Enter your name">
    </div>

    <!-- Phone / WhatsApp Number -->
    <div class="form-group">
      <label for="phoneNumber">Phone / WhatsApp Number</label>
      <input type="text" class="form-control" id="phoneNumber" placeholder="e.g. +234XXXXXXXX">
    </div>

    <!-- Purchase Date -->
    <div class="form-group">
      <label for="purchaseDate">Purchase Date</label>
      <input type="date" class="form-control" id="purchaseDate" placeholder="yyyy/mm/dd">
    </div>

    <!-- Residential State (Select2) -->
    <div class="form-group">
      <label for="state">Residential State</label>
      <select id="state" class="form-control" style="width: 100%;">
        <option value=""></option>
        <!-- 以下示範部分州，請自行補完 -->
        <option value="Abia">Abia</option>
        <option value="Adamawa">Adamawa</option>
        <option value="Akwa Ibom">Akwa Ibom</option>
        <option value="Anambra">Anambra</option>
        <option value="Bauchi">Bauchi</option>
        <option value="Bayelsa">Bayelsa</option>
        <option value="Benue">Benue</option>
        <option value="Borno">Borno</option>
        <option value="Cross River">Cross River</option>
        <option value="Delta">Delta</option>
        <option value="Ebonyi">Ebonyi</option>
        <option value="Edo">Edo</option>
        <option value="Ekiti">Ekiti</option>
        <option value="Enugu">Enugu</option>
        <option value="Gombe">Gombe</option>
        <option value="Imo">Imo</option>
        <option value="Jigawa">Jigawa</option>
        <option value="Kaduna">Kaduna</option>
        <option value="Kano">Kano</option>
        <option value="Katsina">Katsina</option>
        <option value="Kebbi">Kebbi</option>
        <option value="Kogi">Kogi</option>
        <option value="Kwara">Kwara</option>
        <option value="Lagos">Lagos</option>
        <option value="Nasarawa">Nasarawa</option>
        <option value="Niger">Niger</option>
        <option value="Ogun">Ogun</option>
        <option value="Ondo">Ondo</option>
        <option value="Osun">Osun</option>
        <option value="Oyo">Oyo</option>
        <option value="Plateau">Plateau</option>
        <option value="Rivers">Rivers</option>
        <option value="Sokoto">Sokoto</option>
        <option value="Taraba">Taraba</option>
        <option value="Yobe">Yobe</option>
        <option value="Zamfara">Zamfara</option>
        <option value="FCT Abuja">FCT Abuja</option>
      </select>
    </div>

    <!-- Residential LGA (Select2) -->
    <div class="form-group">
      <label for="LGA">Residential LGA</label>
      <select id="LGA" class="form-control" style="width: 100%;">
        <option value=""></option>
      </select>
    </div>

    <button type="submit" class="btn btn-primary">Submit Registration</button>
  </form>
  <!-- 結果訊息區 -->
  <div id="result" class="mt-3"></div>
</div>

<!-- Confirmation Modal -->
<div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="confirmModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confirmModalLabel">Confirm Your Information</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p><strong>Dealer Code:</strong> <span id="confirmDealerCode"></span></p>
        <p><strong>Model:</strong> <span id="confirmModel"></span></p>
        <p><strong>Product Serial:</strong> <span id="confirmProductSerial"></span></p>
        <p><strong>Customer Name:</strong> <span id="confirmCustomerName"></span></p>
        <p><strong>Phone Number:</strong> <span id="confirmPhoneNumber"></span></p>
        <p><strong>Purchase Date:</strong> <span id="confirmPurchaseDate"></span></p>
        <p><strong>Residential State:</strong> <span id="confirmState"></span></p>
        <p><strong>Residential LGA:</strong> <span id="confirmLGA"></span></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button id="confirmBtn" type="button" class="btn btn-primary">Confirm</button>
      </div>
    </div>
  </div>
</div>

<!-- 載入 jQuery 與 Bootstrap JS（注意：請只載入一次） -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- 載入 Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
  // 1. 定義 Dealer Code 與 Model 的假資料
  var dealerCodes = [
    "DealerABC",
    "DealerXYZ",
    "Dealer101",
    "Dealer202",
    "Dealer305",
    "Dealer007",
    "Dealer888",
    "Dealer555",
    "Dealer999",
    "Dealer111"
  ];
  var modelCodes = [
    "ModelAlpha",
    "ModelBeta",
    "ModelGamma",
    "ModelDelta",
    "ModelEpsilon",
    "ModelZeta",
    "ModelEta",
    "ModelTheta",
    "ModelIota",
    "ModelKappa",
    "ModelLambda",
    "ModelMu",
    "ModelNu",
    "ModelXi",
    "ModelOmicron",
    "ModelPi",
    "ModelRho",
    "ModelSigma",
    "ModelTau",
    "ModelOmega"
  ];

  $(document).ready(function() {
    // 初始化 Dealer Code 下拉 (Select2)
    var $dealerSelect = $("#dealerCode");
    dealerCodes.forEach(function(code) {
      $dealerSelect.append(new Option(code, code));
    });
    $dealerSelect.select2({
      placeholder: "e.g. DealerABC",
      theme: "bootstrap4"
    });
    $dealerSelect.on('select2:open', function() {
      $('.select2-search__field').attr('placeholder', 'Type here to search Dealer Code...');
    });

    // 初始化 Model 下拉 (Select2)
    var $modelSelect = $("#model");
    modelCodes.forEach(function(m) {
      $modelSelect.append(new Option(m, m));
    });
    $modelSelect.select2({
      placeholder: "e.g. ModelAlpha",
      theme: "bootstrap4"
    });
    $modelSelect.on('select2:open', function() {
      $('.select2-search__field').attr('placeholder', 'Type here to search Model...');
    });

    // 初始化 Residential State 下拉 (Select2)
    $("#state").select2({
      placeholder: "Type to search State...",
      theme: "bootstrap4"
    });

    // 初始化 Residential LGA 下拉 (Select2) (初始為空)
    $("#LGA").select2({
      placeholder: "Type to search LGA...",
      theme: "bootstrap4"
    });

    // 當 Residential State 改變時，根據選擇動態填入 Residential LGA 選項
    $("#state").on("change", function() {
      const selectedState = $(this).val();
      const $LGASelect = $("#LGA");
      $LGASelect.html('<option value=""></option>'); // 清空舊選項

      // 定義各州對應的 LGA (示範部分資料)
      const LGAByState = {
        "Abia": ["Aba North", "Aba South", "Arochukwu", "Bende", "Ikwuano", "Isiala-Ngwa North", "Isiala-Ngwa South", "Isuikwato", "Ngwa", "Obi Nwa", "Ohafia", "Osisioma", "Ugwunagbo", "Ukwa East", "Ukwa West", "Umu-Neochi", "Umuahia North", "Umuahia South"],
        "Adamawa": ["Demsa", "Fufore", "Ganaye", "Gireri", "Gombi", "Guyuk", "Hong", "Jada", "Lamurde", "Madagali", "Maiha", "Mayo-Belwa", "Michika", "Mubi North", "Mubi South", "Numan", "Shelleng", "Song", "Toungo", "Yola North", "Yola South"],
        "Akwa Ibom": ["Abak", "Eastern Obolo", "Eket", "Esit Eket", "Essien Udim", "Etim Ekpo", "Etinan", "Ibeno", "Ibesikpo Asutan", "Ibiono Ibom", "Ika", "Ikono", "Ikot Abasi", "Ikot Ekpene", "Ini", "Itu", "Mbo", "Mkpat Enin", "Nsit Atai", "Nsit Ibom", "Nsit Ubium", "Obot Akara", "Okobo", "Onna", "Oron", "Oruk Anam", "Udung Uko", "Ukanafun", "Uruan", "Urue-Offong/Oruko", "Uyo"],
        "Anambra": ["Aguata", "Anambra East", "Anambra West", "Anaocha", "Awka North", "Awka South", "Ayamelum", "Dunukofia", "Ekwusigo", "Idemili North", "Idemili south", "Ihiala", "Njikoka", "Nnewi North", "Nnewi South", "Ogbaru", "Onitsha North", "Onitsha South", "Orumba North", "Orumba South", "Oyi"],
        "Bauchi": ["Alkaleri", "Bauchi", "Bogoro", "Damban", "Darazo", "Dass", "Gamawa", "Ganjuwa", "Giade", "Itas/Gadau", "Jama'are", "Katagum", "Kirfi", "Misau", "Ningi", "Shira", "Tafawa-Balewa", "Toro", "Warji", "Zaki"],
        "Bayelsa": ["Brass", "Ekeremor", "Kolokuma/Opokuma", "Nembe", "Ogbia", "Sagbama", "Southern Jaw", "Yenegoa"],
        "Benue": ["Ado", "Agatu", "Apa", "Buruku", "Gboko", "Guma", "Gwer East", "Gwer West", "Katsina-Ala", "Konshisha", "Kwande", "Logo", "Makurdi", "Obi", "Ogbadibo", "Ohimini", "Oju", "Okpokwu", "Oturkpo", "Tarka", "Ukum", "Ushongo", "Vandeikya"],
        "Borno": ["Abadam", "Askira/Uba", "Bama", "Bayo", "Biu", "Chibok", "Damboa", "Dikwa", "Gubio", "Guzamala", "Gwoza", "Hawul", "Jere", "Kaga", "Kala/Balge", "Konduga", "Kukawa", "Kwaya Kusar", "Mafa", "Magumeri", "Maiduguri", "Marte", "Mobbar", "Monguno", "Ngala", "Nganzai", "Shani"],
        "Cross River": ["Abi", "Akamkpa", "Akpabuyo", "Bakassi", "Bekwara", "Biase", "Boki", "Calabar Municipality", "Calabar South", "Etung", "Ikom", "Obanliku", "Obudu", "Odubra", "Odukpani", "Ogoja", "Yala", "Yarkur"],
        "Delta": ["Aniocha", "Aniocha South", "Bomadi", "Burutu", "Ethiope East", "Ethiope West", "Ika North-East", "Ika South", "Isoko North", "Isoko south", "Ndokwa East", "Ndokwa West", "Okpe", "Oshimili", "Oshimili North", "Patani", "Sapele", "Udu", "Ughelli North", "Ughelli South", "Ukwani", "Uvwie", "Warri Central", "Warri North", "Warri South"],
        "Ebonyi": ["Abakaliki", "Afikpo", "Ebonyi", "Edda", "Ezza", "Ezza Central", "Ezza South", "Ishielu", "Ivo", "lkwo", "Ohaozara", "Ohaukwu", "Onicha"],
        "Edo": ["Central", "Egor", "Esan Central", "Esan North-East", "Esan South-East", "Esan West", "Etsako Central", "Etsako East", "Etsako West", "Igueben", "Ikpoba-Okha", "Oredo", "Orhionwon", "Ovia North-East", "Ovia South-East", "Ovia SouthWest", "Uhunmwonde", "Ukpoba"],
        "Ekiti": ["Ado Ekiti", "Efon", "Ekiti South-West", "Ekiti-East", "Ekiti-West", "Emure/Ise/Orun", "Gbonyin", "Ido/Osi", "Ijero", "Ikere", "Ikole", "Ilejemeje.", "Irepodun-Ifelodun", "Ise/Orun", "Moba", "Oye"],
        "Enugu": ["Aninri", "Enugu Eas", "Enugu North", "Enugu South", "Ezeagu", "Igbo-Ekiti", "Igbo-Eze South", "IgboEze North", "Isi-Uzo", "Nkanu", "Nkanu East", "Nkanu West", "Nsukka", "Oji-River", "Udenu.", "Udi Agwu", "Uzo-Uwani"],
        "FCT": ["Abaji", "Abuja Municipal", "Bwari", "Gwagwalada", "Kuje", "Kwali"],
        "Gombe": ["Akko", "Balanga", "Billiri", "Dukku", "Funakaye", "Gombe", "Kaltungo", "Kwami", "Nafada/Bajoga", "Shomgom", "Yamaltu/Delta."],
        "Imo": ["Aboh-Mbaise", "Ahiazu-Mbaise", "Ehime-Mbano", "Ezinihitte", "Ideato North", "Ideato South", "Ihitte/Uboma", "Ikeduru", "Isiala Mbano", "Isu", "Mbaitoli", "Ngor-Okpala", "Njaba", "Nkwerre", "Nwangele", "Obowo", "Oguta", "Ohaji/Egbema", "Okigwe", "Orlu", "Orsu", "Oru East", "Oru West", "Owerri North", "Owerri West", "Owerri-Municipal"],
        "Jigawa": ["Auyo", "Babura", "Biriniwa", "Birni Kudu", "Buji", "Dutse", "Gagarawa", "Garki", "Gumel", "Guri", "Gwaram", "Gwiwa", "Hadejia", "Jahun", "Kafin Hausa", "Kaugama Kazaure", "Kiri Kasamma", "Kiyawa", "Maigatari", "Malam Madori", "Miga", "Ringim", "Roni", "Sule-Tankarkar", "Taura", "Yankwashi"],
        "Kaduna": ["Birni-Gwari", "Chikun", "Giwa", "Igabi", "Ikara", "jaba", "Jema'a", "Kachia", "Kaduna North", "Kaduna South", "Kagarko", "Kajuru", "Kaura", "Kauru", "Kubau", "Kudan", "Lere", "Makarfi", "Sabon-Gari", "Sanga", "Soba", "Zango-Kataf", "Zaria"],
        "Kano": ["Ajingi", "Albasu", "Bagwai", "Bebeji", "Bichi", "Bunkure", "Dala", "Dambatta", "Dawakin Kudu", "Dawakin Tofa", "Doguwa", "Fagge", "Gabasawa", "Garko", "Garum", "Gaya", "Gezawa", "Ghari", "Gwale", "Gwarzo", "Kabo", "Kano Municipal", "Karaye", "Kibiya", "Kiru", "kumbotso", "Kunchi", "Kura", "Madobi", "Makoda", "Mallam", "Minjibir", "Nasarawa", "Rano", "Rimin Gado", "Rogo", "Shanono", "Sumaila", "Takali", "Tarauni", "Tofa", "Tsanyawa", "Tudun Wada", "Ungogo", "Warawa", "Wudil"],
        "Katsina": ["Bakori", "Batagarawa", "Batsari", "Baure", "Bindawa", "Charanchi", "Dan Musa", "Dandume", "Danja", "Daura", "Dutsi", "Dutsin-Ma", "Faskari", "Funtua", "Ingawa", "Jibia", "Kafur", "Kaita", "Kankara", "Kankia", "Katsina", "Kurfi", "Kusada", "Mai'Adua", "Malumfashi", "Mani", "Mashi", "Matazuu", "Musawa", "Rimi", "Sabuwa", "Safana", "Sandamu", "Zango"],
        "Kebbi": ["Aleiro", "Arewa-Dandi", "Argungu", "Augie", "Bagudo", "Birnin Kebbi", "Bunza", "Dandi", "Fakai", "Gwandu", "Jega", "Kalgo", "Koko/Besse", "Maiyama", "Ngaski", "Sakaba", "Shanga", "Suru", "Wasagu/Danko", "Yauri", "Zuru"],
        "Kogi": ["Adavi", "Ajaokuta", "Ankpa", "Bassa", "Dekina", "Ibaji", "Idah", "Igalamela-Odolu", "Ijumu", "Kabba/Bunu", "Kogi", "Lokoja", "Mopa-Muro", "Ofu", "Ogori/Mangongo", "Okehi", "Okene", "Olamabolo", "Omala", "Yagba East", "Yagba West"],
        "Kwara": ["Asa", "Baruten", "Edu", "Ekiti", "Ifelodun", "Ilorin East", "Ilorin West", "Irepodun", "Isin", "Kaiama", "Moro", "Offa", "Oke-Ero", "Oyun", "Pategi"],
        "Lagos": ["Agege", "Ajeromi-Ifelodun", "Alimosho", "Amuwo-Odofin", "Apapa", "Badagry", "Epe", "Eti-Osa", "Ibeju/Lekki", "Ifako-Ijaye", "Ikeja", "Ikorodu", "Kosofe", "Lagos Island", "Lagos Mainland", "Mushin", "Ojo", "Oshodi-Isolo", "Shomolu", "Surulere"],
        "Nasarawa": ["Akwanga", "Awe", "Doma", "Karu", "Keana", "Keffi", "Kokona", "Lafia", "Nasarawa", "Nasarawa-Eggon", "Obi", "Toto", "Wamba"],
        "Niger": ["Agaie", "Agwara", "Bida", "Borgu", "Bosso", "Chanchaga", "Edati", "Gbako", "Gurara", "Katcha", "Kontagora", "Lapai", "Lavun", "Magama", "Mariga", "Mashegu", "Mokwa", "Muya", "Pailoro", "Rafi", "Rijau", "Shiroro", "Suleja", "Tafa", "Wushishi"],
        "Ogun": ["Abeokuta North", "Abeokuta South", "Ado-Odo/Ota", "Ewekoro", "Ifo", "Ijebu East", "Ijebu North", "Ijebu North East", "Ijebu Ode", "Ikenne", "Imeko-Afon", "Ipokia", "Obafemi-Owode", "Odeda", "Odogbolu", "Ogun Waterside", "Remo North", "Shagamu", "Yewa North", "Yewa South"],
        "Ondo": ["Akoko North East", "Akoko North West", "Akoko South East", "Akoko South West", "Akure North", "Akure South", "Ese-Odo", "Idanre", "Ifedore", "Ilaje", "Ile-Oluji", "Irele", "Odigbo", "Okeigbo", "Okitipupa", "Ondo East", "Ondo West", "Ose", "Owo"],
        "Osun": ["Aiyedade", "Aiyedire", "Atakumosa East", "Atakumosa West", "Boluwaduro", "Boripe", "Ede North", "Ede South", "Egbedore", "Ejigbo", "Ife Central", "Ife East", "Ife North", "Ife South", "Ifedayo", "Ifelodun", "Ila", "Ilesha East", "Ilesha West", "Irepodun", "Irewole", "Isokan", "Iwo", "Obokun", "Odo-Otin", "Ola-Oluwa", "Olorunda", "Oriade", "Orolu", "Osogbo"],
        "Oyo": ["Afijio", "Akinyele", "Atiba", "Atisbo", "Egbeda", "Ibadan Central", "Ibadan North", "Ibadan North West", "Ibadan South East", "Ibadan South West", "Ibarapa Central", "Ibarapa East", "Ibarapa North", "Ido", "Irepo", "Iseyin", "Itesiwaju", "Iwajowa", "Kajola", "Lagelu Ogbomosho North", "Ogbomosho South", "Ogo Oluwa", "Olorunsogo", "Oluyole", "Ona-Ara", "Orelope", "Ori Ire", "Oyo East", "Oyo West", "Saki East", "Saki West", "Surulere"],
        "Plateau": ["Barikin Ladi", "Bassa", "Bokkos", "Jos East", "Jos North", "Jos South", "Kanam", "Kanke", "Langtang North", "Langtang South", "Mangu", "Mikang", "Pankshin", "Qua'an Pan", "Riyom", "Shendam", "Wase"],
        "Rivers": ["Abua/Odual", "Ahoada East", "Ahoada West", "Akuku Toru", "Andoni", "Asari-Toru", "Bonny", "Degema", "Eleme", "Emohua", "Etche", "Gokana", "Ikwerre", "Khana", "Obio/Akpor", "Ogba/Egbema/Ndoni", "Ogu/Bolo", "Okrika", "Omumma", "Opobo/Nkoro", "Oyigbo", "Port-Harcourt", "Tai"],
        "Sokoto": ["Binji", "Bodinga", "Dange-shnsi", "Gada", "Gawabawa", "Goronyo", "Gudu", "Illela", "Isa", "kebbe", "Kware", "Rabah", "Sabon birni", "Shagari", "Silame", "Sokoto North", "Sokoto South", "Tambuwal", "Tqngaza", "Tureta", "Wamako", "Wurno", "Yabo"],
        "Taraba": ["Ardo-kola", "Bali", "Cassol", "Donga", "Gashaka", "Ibi", "Jalingo", "Karin-Lamido", "Kurmi", "Lau", "Sardauna", "Takum", "Ussa", "Wukari", "Yorro", "Zing"],
        "Yobe": ["Bade", "Bursari", "Damaturu", "Fika", "Fune", "Geidam", "Gujba", "Gulani", "Jakusko", "Karasuwa", "Karawa", "Machina", "Nangere", "Nguru Potiskum", "Tarmua", "Yunusari", "Yusufari"],
        "Zamfara": ["Anka", "Bakura", "Birnin Magaji", "Bukkuyum", "Bungudu", "Gummi", "Gusau", "Kaura-Namoda", "Maradun", "Maru", "Namoda", "Shinkafi", "Talata Mafara", "Tsafe", "Zurmi"],
      };

      if (selectedState && LGAByState[selectedState]) {
        LGAByState[selectedState].forEach(function(lga) {
          $LGASelect.append(new Option(lga, lga));
        });
      }
      $LGASelect.select2({
        placeholder: "Type to search LGA...",
        theme: "bootstrap4"
      });
    });
  });

  // 定義檢查非法字元的函式
  function isInvalidInput(value) {
    // 只允許英文字母、數字、空白與 -_,.()/ 符號
    const pattern = /^[a-zA-Z0-9\s\-\_,.()\/]*$/;
    return !pattern.test(value);
  }

  // 表單提交時的處理函式：先顯示確認 Modal
  function handleSubmit(e) {
    e.preventDefault();

    // 取得各欄位值，並 trim() 去除前後空白
    const dealerCode    = $("#dealerCode").val().trim();
    const model         = $("#model").val().trim();
    const productSerial = $("#productSerial").val().trim();
    const customerName  = $("#CustomerName").val().trim();
    const phoneNumber   = $("#phoneNumber").val().trim();
    const purchaseDate  = $("#purchaseDate").val().trim();
    const state         = $("#state").val().trim();
    const LGA           = $("#LGA").val().trim();

    // 檢查必填欄位是否有空值
    if (!dealerCode || !model || !productSerial || !customerName || !phoneNumber || !purchaseDate || !state || !LGA) {
      $("#result").text("Please fill out all required fields.").removeClass("text-success").addClass("text-danger");
      return;
    }

    // 檢查是否含有非法字元
    if (isInvalidInput(dealerCode) || isInvalidInput(model) || isInvalidInput(productSerial) ||
        isInvalidInput(customerName) || isInvalidInput(phoneNumber) || isInvalidInput(purchaseDate) ||
        isInvalidInput(state) || isInvalidInput(LGA)) {
      $("#result").text("Invalid characters detected.").removeClass("text-success").addClass("text-danger");
      return;
    }

    // 將各欄位值填入確認 Modal
    $("#confirmDealerCode").text(dealerCode);
    $("#confirmModel").text(model);
    $("#confirmProductSerial").text(productSerial);
    $("#confirmCustomerName").text(customerName);
    $("#confirmPhoneNumber").text(phoneNumber);
    $("#confirmPurchaseDate").text(purchaseDate);
    $("#confirmState").text(state);
    $("#confirmLGA").text(LGA);

    // 顯示確認 Modal
    $("#confirmModal").modal("show");

    // 當使用者在 Modal 按下 Confirm 按鈕
    $("#confirmBtn").off("click").on("click", function() {
      $("#confirmModal").modal("hide");

      // 組合表單資料 (使用 URLSearchParams)
      const formData = new URLSearchParams();
      formData.append("dealerCode", dealerCode);
      formData.append("model", model);
      formData.append("productSerial", productSerial);
      formData.append("CustomerName", customerName);
      formData.append("phoneNumber", phoneNumber);
      formData.append("purchaseDate", purchaseDate);
      formData.append("state", state);
      formData.append("LGA", LGA);

      // 呼叫後端 Apps Script (請將 URL 替換為你的部署 exec URL)
      fetch("https://script.google.com/macros/s/AKfycbzECGqAyJ7Gf88Tgw1DpG4C9mW1qFQCq0OtPmmx1RGS-_esSBE8WOmwed3-Fc5kDdPH/exec", {
        method: "POST",
        body: formData
      })
      .then(response => response.text())
      .then(text => {
        let data;
        try {
          data = JSON.parse(text);
       } catch {
          // 1. 回傳格式錯誤
          alert("⚠️ Response format error. Please try again later.");
          return;
        }
        if (data.result === "success") {
          // 2. 註冊成功
          alert("✅ Registration successful!");
          resetForm();
        } else {
          // 3. 註冊失敗
          alert("❌ Registration failed: " + (data.error || "Unknown error."));
        }
      })
      .catch(() => {
        // 4. 網路或伺服器錯誤
        alert("❌ Network/server error. Please try again later.");
      });
    });
    // 這個函式負責「清空整張表單」
function resetForm() {
  // 請幫你的 <form> 加上 id="vipForm"
  document.getElementById("vipForm").reset();

  // Select2 欄位要手動清除並觸發 change
  $("#dealerCode, #model, #state, #LGA")
    .val(null)
    .trigger("change");

  // 同步清掉下方訊息
  $("#result").text("").removeClass("text-success text-danger");
}
  }
</script>
</body>
</html>
